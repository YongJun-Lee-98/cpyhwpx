# HWP Automation Preset Schema
# Claude Code가 HWP 자동화 작업 시 참조하는 프리셋 스키마 정의
# Version: 1.0.0

schema_version: "1.0"
description: "cpyhwpx 프리셋 시스템 스키마 정의"

# 프리셋 구조 정의
preset_structure:
  required_fields:
    - id          # 고유 식별자 (영문_소문자_언더스코어)
    - name        # 한글 이름
    - description # 상세 설명
    - category    # 카테고리
    - actions     # 실행할 액션 목록

  optional_fields:
    - preconditions   # 사전 조건
    - postconditions  # 완료 후 상태
    - examples        # 사용 예시
    - error_handling  # 에러 처리

# 카테고리 정의
categories:
  table:
    description: "표 생성, 셀 이동, 데이터 입력, 병합/분할 등 표 관련 작업"
    file: "table.yaml"
  text:
    description: "텍스트 편집, 서식 적용, 찾기/바꾸기 등 텍스트 관련 작업"
    file: "text.yaml"
  field:
    description: "필드 생성, 값 설정, 메타태그 관련 작업"
    file: "field.yaml"
  shape:
    description: "이미지, 도형, 개체 삽입 및 조작"
    file: "shape.yaml"
  document:
    description: "파일 I/O, 페이지 설정, 구역, 머리글/바닥글 등 문서 구조 작업"
    file: "document.yaml"
  navigation:
    description: "커서 이동, 위치 저장/복원, 컨트롤 탐색"
    file: "navigation.yaml"

# 사전 조건 타입 정의
precondition_types:
  cursor_in_table:
    type: boolean
    description: "커서가 표 안에 있어야 함"
    check_method: "IsCell"

  cursor_in_cell:
    type: boolean
    description: "커서가 셀 안에 있어야 함"
    check_method: "IsCell"

  has_selection:
    type: boolean
    description: "선택 영역이 있어야 함"
    check_method: "GetSelectedText"

  control_selected:
    type: string
    description: "특정 컨트롤이 선택되어 있어야 함"
    values:
      - tbl   # 표
      - gso   # 그리기 개체
      - pic   # 그림
      - eqed  # 수식
      - ole   # OLE 개체
    check_method: "GetCurSelectedCtrl"

  check_method:
    type: string
    description: "커스텀 확인 메서드 지정"

# 액션 타입 정의
action_types:
  run:
    description: "HAction.Run() 액션 실행"
    required_params:
      - action  # 액션 이름 (예: TableLeftCell, CharShapeBold)
    optional_params:
      - description
      - on_error
    reference: "src/HwpAction.h, docs/mapping/09_run_actions.md"

  method:
    description: "HwpWrapper 메서드 호출"
    required_params:
      - action  # 메서드 이름 (예: InsertText, SetFont)
    optional_params:
      - params      # 메서드 파라미터
      - description
      - on_error
    reference: "src/HwpWrapper.h, docs/mapping/"

  conditional:
    description: "조건부 실행 (if/else)"
    required_params:
      - condition   # 조건식
      - then        # 조건 참일 때 액션
    optional_params:
      - else        # 조건 거짓일 때 액션

  loop:
    description: "반복 실행"
    required_params:
      - actions     # 반복할 액션 목록
    optional_params:
      - count       # 반복 횟수 (또는 변수)
      - until       # 종료 조건
      - description

# on_error 옵션
error_options:
  abort:
    description: "에러 발생 시 즉시 중단"
    default: true
  continue:
    description: "에러 무시하고 계속 진행"
  retry:
    description: "에러 발생 시 재시도"
    max_retries: 3

# 변수 문법
variable_syntax:
  pattern: "{{variable_name}}"
  with_default: "{{variable_name|default_value}}"
  description: "프리셋에서 사용자 입력을 받는 변수"
  examples:
    - "{{content}}"
    - "{{font_name|맑은 고딕}}"
    - "{{font_size|1200}}"
    - "{{index|0}}"

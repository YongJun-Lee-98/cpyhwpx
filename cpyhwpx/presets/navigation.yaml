# HWP Automation Presets - Navigation
# 커서 이동, 위치 저장/복원, 컨트롤 탐색
# Version: 1.0.0

presets:
  # ============================================
  # 문서 내 이동
  # ============================================
  - id: nav_move_doc_begin
    name: "문서 처음으로"
    description: "문서의 맨 처음으로 커서를 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "MoveDocBegin"
        description: "문서 처음으로"

    postconditions:
      cursor_position: "문서 첫 번째 위치"

    examples:
      - scenario: "기본 사용"
        code: |
          hwp.run("MoveDocBegin")

  - id: nav_move_doc_end
    name: "문서 끝으로"
    description: "문서의 맨 끝으로 커서를 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "MoveDocEnd"
        description: "문서 끝으로"

    postconditions:
      cursor_position: "문서 마지막 위치"

    examples:
      - scenario: "기본 사용"
        code: |
          hwp.run("MoveDocEnd")

  - id: nav_move_page
    name: "페이지 이동"
    description: "지정된 페이지로 이동합니다."
    category: navigation

    actions:
      - type: method
        action: "GotoPage"
        params:
          pageIndex: "{{page_number}}"
        description: "페이지 이동"

    examples:
      - scenario: "3페이지로 이동"
        code: |
          hwp.GotoPage(3)
      - scenario: "첫 페이지로 이동"
        code: |
          hwp.GotoPage(1)

  - id: nav_move_para
    name: "문단 이동"
    description: "문단의 처음 또는 끝으로 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "{{direction}}"
        description: "문단 이동"

    available_directions:
      - MoveParaBegin   # 문단 처음
      - MoveParaEnd     # 문단 끝
      - MoveNextPara    # 다음 문단
      - MovePrevPara    # 이전 문단

    examples:
      - scenario: "문단 처음으로"
        code: |
          hwp.run("MoveParaBegin")
      - scenario: "다음 문단으로"
        code: |
          hwp.run("MoveNextPara")

  - id: nav_move_line
    name: "줄 이동"
    description: "줄의 처음 또는 끝으로 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "{{direction}}"
        description: "줄 이동"

    available_directions:
      - MoveLineBegin   # 줄 처음
      - MoveLineEnd     # 줄 끝
      - MoveLineUp      # 위 줄
      - MoveLineDown    # 아래 줄

    examples:
      - scenario: "줄 처음으로"
        code: |
          hwp.run("MoveLineBegin")
      - scenario: "줄 끝으로"
        code: |
          hwp.run("MoveLineEnd")

  - id: nav_move_word
    name: "단어 이동"
    description: "단어 단위로 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "{{direction}}"
        description: "단어 이동"

    available_directions:
      - MoveWordBegin   # 단어 처음
      - MoveWordEnd     # 단어 끝
      - MoveNextWord    # 다음 단어
      - MovePrevWord    # 이전 단어

    examples:
      - scenario: "다음 단어로"
        code: |
          hwp.run("MoveNextWord")
      - scenario: "이전 단어로"
        code: |
          hwp.run("MovePrevWord")

  - id: nav_move_char
    name: "글자 이동"
    description: "글자 단위로 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "{{direction}}"
        description: "글자 이동"

    available_directions:
      - MoveLeft        # 왼쪽
      - MoveRight       # 오른쪽
      - MoveNextChar    # 다음 글자
      - MovePrevChar    # 이전 글자

    examples:
      - scenario: "왼쪽으로"
        code: |
          hwp.run("MoveLeft")
      - scenario: "오른쪽으로"
        code: |
          hwp.run("MoveRight")

  # ============================================
  # 위치 저장/복원
  # ============================================
  - id: nav_save_position
    name: "위치 저장"
    description: "현재 커서 위치를 저장합니다."
    category: navigation

    actions:
      - type: method
        action: "GetPos"
        description: "현재 위치 저장"

    examples:
      - scenario: "위치 저장"
        code: |
          list_id, para, pos = hwp.GetPos()
          # 저장된 위치 사용
          print(f"위치: list={list_id}, para={para}, pos={pos}")

  - id: nav_restore_position
    name: "위치 복원"
    description: "저장된 위치로 커서를 복원합니다."
    category: navigation

    actions:
      - type: method
        action: "SetPos"
        params:
          list: "{{list_id}}"
          para: "{{para}}"
          pos: "{{pos}}"
        description: "위치 복원"

    examples:
      - scenario: "위치 복원"
        code: |
          hwp.SetPos(list_id, para, pos)

  - id: nav_save_restore_workflow
    name: "위치 저장 후 작업 후 복원"
    description: "현재 위치를 저장하고 다른 작업 후 복원합니다."
    category: navigation

    actions:
      - type: method
        action: "GetPosBySetPy"
        description: "위치 인덱스 저장"
      - type: comment
        description: "다른 작업 수행..."
      - type: method
        action: "SetPosBySetPy"
        params:
          index: "{{saved_index}}"
        description: "위치 복원"

    examples:
      - scenario: "작업 흐름"
        code: |
          # 현재 위치 저장
          pos_idx = hwp.GetPosBySetPy()

          # 다른 작업 수행
          hwp.run("MoveDocEnd")
          hwp.InsertText("추가 내용")

          # 원래 위치로 복원
          hwp.SetPosBySetPy(pos_idx)

  # ============================================
  # 빠른 마크
  # ============================================
  - id: nav_quick_mark_set
    name: "빠른 마크 설정"
    description: "현재 위치에 빠른 마크를 설정합니다 (0-9)."
    category: navigation

    actions:
      - type: run
        action: "QuickMarkInsert{{number}}"
        description: "빠른 마크 설정"

    available_marks:
      - QuickMarkInsert0
      - QuickMarkInsert1
      - QuickMarkInsert2
      - QuickMarkInsert3
      - QuickMarkInsert4
      - QuickMarkInsert5
      - QuickMarkInsert6
      - QuickMarkInsert7
      - QuickMarkInsert8
      - QuickMarkInsert9

    examples:
      - scenario: "마크 0 설정"
        code: |
          hwp.run("QuickMarkInsert0")
      - scenario: "마크 1 설정"
        code: |
          hwp.run("QuickMarkInsert1")

  - id: nav_quick_mark_move
    name: "빠른 마크로 이동"
    description: "설정된 빠른 마크로 이동합니다 (0-9)."
    category: navigation

    actions:
      - type: run
        action: "QuickMarkMove{{number}}"
        description: "빠른 마크로 이동"

    available_moves:
      - QuickMarkMove0
      - QuickMarkMove1
      - QuickMarkMove2
      - QuickMarkMove3
      - QuickMarkMove4
      - QuickMarkMove5
      - QuickMarkMove6
      - QuickMarkMove7
      - QuickMarkMove8
      - QuickMarkMove9

    examples:
      - scenario: "마크 0으로 이동"
        code: |
          hwp.run("QuickMarkMove0")
      - scenario: "마크 1으로 이동"
        code: |
          hwp.run("QuickMarkMove1")

  # ============================================
  # 컨트롤 탐색
  # ============================================
  - id: nav_get_controls
    name: "컨트롤 목록 조회"
    description: "문서 내 모든 컨트롤(표, 그림 등)을 조회합니다."
    category: navigation

    actions:
      - type: method
        action: "GetCtrlList"
        description: "컨트롤 목록 조회"

    examples:
      - scenario: "모든 컨트롤 조회"
        code: |
          ctrls = hwp.GetCtrlList()
          for ctrl in ctrls:
              print(f"ID: {ctrl.CtrlID}, Type: {ctrl.CtrlType}")
      - scenario: "표만 필터링"
        code: |
          ctrls = hwp.GetCtrlList()
          tables = [c for c in ctrls if c.CtrlID == 'tbl']
          print(f"표 개수: {len(tables)}")
      - scenario: "그림만 필터링"
        code: |
          ctrls = hwp.GetCtrlList()
          pics = [c for c in ctrls if c.CtrlID == 'pic']

  - id: nav_move_to_control
    name: "컨트롤로 이동"
    description: "특정 컨트롤로 커서를 이동합니다."
    category: navigation

    actions:
      - type: method
        action: "MoveToCtrl"
        params:
          pCtrl: "{{control}}"
          option: "{{position|0}}"
        description: "컨트롤로 이동"

    position_options:
      0: "컨트롤 앞"
      1: "컨트롤 뒤"
      2: "컨트롤 안"

    examples:
      - scenario: "첫 번째 표로 이동"
        code: |
          ctrls = hwp.GetCtrlList()
          tables = [c for c in ctrls if c.CtrlID == 'tbl']
          if tables:
              hwp.MoveToCtrl(tables[0], option=2)  # 표 안으로

  - id: nav_select_control
    name: "컨트롤 선택"
    description: "특정 컨트롤을 선택합니다."
    category: navigation

    actions:
      - type: method
        action: "SelectCtrl"
        params:
          pCtrl: "{{control}}"
        description: "컨트롤 선택"

    examples:
      - scenario: "첫 번째 그림 선택"
        code: |
          ctrls = hwp.GetCtrlList()
          pics = [c for c in ctrls if c.CtrlID == 'pic']
          if pics:
              hwp.SelectCtrl(pics[0])

  - id: nav_get_head_ctrl
    name: "첫 컨트롤 조회"
    description: "문서의 첫 번째 컨트롤을 조회합니다."
    category: navigation

    actions:
      - type: method
        action: "GetHeadCtrl"
        description: "첫 컨트롤 조회"

    examples:
      - scenario: "첫 컨트롤부터 순회"
        code: |
          ctrl = hwp.GetHeadCtrl()
          while ctrl:
              print(f"ID: {ctrl.CtrlID}")
              ctrl = ctrl.Next()

  - id: nav_get_last_ctrl
    name: "마지막 컨트롤 조회"
    description: "문서의 마지막 컨트롤을 조회합니다."
    category: navigation

    actions:
      - type: method
        action: "GetLastCtrl"
        description: "마지막 컨트롤 조회"

    examples:
      - scenario: "기본 사용"
        code: |
          ctrl = hwp.GetLastCtrl()
          if ctrl:
              print(f"마지막 컨트롤: {ctrl.CtrlID}")

  # ============================================
  # 선택하며 이동
  # ============================================
  - id: nav_select_move
    name: "선택하며 이동"
    description: "텍스트를 선택하면서 이동합니다."
    category: navigation

    actions:
      - type: run
        action: "{{direction}}"
        description: "선택하며 이동"

    available_directions:
      - MoveSelLeft         # 왼쪽으로 선택
      - MoveSelRight        # 오른쪽으로 선택
      - MoveSelUp           # 위로 선택
      - MoveSelDown         # 아래로 선택
      - MoveSelLineBegin    # 줄 처음까지 선택
      - MoveSelLineEnd      # 줄 끝까지 선택
      - MoveSelParaBegin    # 문단 처음까지 선택
      - MoveSelParaEnd      # 문단 끝까지 선택
      - MoveSelDocBegin     # 문서 처음까지 선택
      - MoveSelDocEnd       # 문서 끝까지 선택
      - MoveSelNextWord     # 다음 단어까지 선택
      - MoveSelPrevWord     # 이전 단어까지 선택

    examples:
      - scenario: "줄 끝까지 선택"
        code: |
          hwp.run("MoveSelLineEnd")
      - scenario: "문서 끝까지 선택"
        code: |
          hwp.run("MoveSelDocEnd")
      - scenario: "다음 단어까지 선택"
        code: |
          hwp.run("MoveSelNextWord")

  # ============================================
  # MovePos 메서드
  # ============================================
  - id: nav_move_pos
    name: "MovePos로 이동"
    description: "MovePos 메서드를 사용하여 지정된 위치로 이동합니다."
    category: navigation

    actions:
      - type: method
        action: "MovePos"
        params:
          move_id: "{{move_id}}"
        description: "지정 위치로 이동"

    move_ids:
      0: "Top - 문서 처음"
      1: "Bottom - 문서 끝"
      2: "ListBegin - 리스트 처음"
      3: "ListEnd - 리스트 끝"
      4: "ParaBegin - 문단 처음"
      5: "ParaEnd - 문단 끝"
      6: "LineBegin - 줄 처음"
      7: "LineEnd - 줄 끝"
      8: "WordBegin - 단어 처음"
      9: "WordEnd - 단어 끝"
      10: "NextPara - 다음 문단"
      11: "PrevPara - 이전 문단"
      12: "NextWord - 다음 단어"
      13: "PrevWord - 이전 단어"
      14: "NextLine - 다음 줄"
      15: "PrevLine - 이전 줄"
      16: "NextChar - 다음 글자"
      17: "PrevChar - 이전 글자"

    examples:
      - scenario: "문서 처음으로 (MoveID 사용)"
        code: |
          hwp.MovePos(0)  # Top
      - scenario: "문단 끝으로"
        code: |
          hwp.MovePos(5)  # ParaEnd
